var turingSNApp=angular.module("turingSNApp","ngCookies ngResource ngAnimate ngSanitize ui.router ui.bootstrap pascalprecht.translate angularMoment".split(" "));
turingSNApp.config(["$stateProvider","$urlRouterProvider","$locationProvider","$translateProvider",function(a,b,e,d){d.useSanitizeValueStrategy("escaped");e.html5Mode(!0);d.translations("en",{REMOVE:"Remove",FIRST:"First",LAST:"Last",PREVIOUS:"Previous",NEXT:"Next",SEARCH:"Search",SEARCH_FOR:"Search for",NO_RESULTS_FOUND:"No results found",APPLIED_FILTERS:"Applied Filters",SHOWING:"Showing",OF:"of",RESULTS:"results",ORDER_BY:"Order by",RELEVANCE:"Relevance",NEWEST:"Newest",OLDEST:"Oldest",SUBJECTS_FOUND:"Subjects found"});
d.translations("pt",{REMOVE:"Remover",FIRST:"Primeiro",LAST:"\u00daltimo",PREVIOUS:"Anterior",NEXT:"Pr\u00f3ximo",SEARCH:"Pesquisar",SEARCH_FOR:"Pesquisar por",NO_RESULTS_FOUND:"Nenhum resultado encontrado",APPLIED_FILTERS:"Filtros Aplicados",SHOWING:"Exibindo",OF:"de",RESULTS:"resultados",ORDER_BY:"Ordenar por",RELEVANCE:"Relev\u00e2ncia",NEWEST:"Mais recente",OLDEST:"Mais antigo",SUBJECTS_FOUND:"Assuntos Encontrados"});d.fallbackLanguage("en")}]);
turingSNApp.service("turAPIServerService",["$http","$location","$cookies",function(a,b,e){a=b.protocol();var d=b.host();b=b.port();var f=a+"://"+d+":"+b+"/api";this.get=function(){if(null!=e.get("turAPIServer"))return e.get("turAPIServer");e.put("turAPIServer",f);return f}}]);
turingSNApp.factory("vigLocale",["$window",function(a){return{getLocale:function(){var b=a.navigator;return angular.isArray(b.languages)&&0<b.languages.length?b.languages[0].split("-").join("_"):(b.language||b.browserLanguage||b.systemLanguage||b.userLanguage||"").split("-").join("_")}}}]);
turingSNApp.controller("TurSNMainCtrl",["$scope","$http","$window","$state","$rootScope","$translate","$location","turSNSearch","amMoment","vigLocale","$location","$anchorScroll","$sce",function(a,b,e,d,f,g,c,h,k,l,c,m,n){a.vigLanguage=l.getLocale().substring(0,2);g.use(a.vigLanguage);k.changeLocale("en");a.pageCount=0;a.pageStart=0;a.pageEnd=0;a.defaultTitleField="title";a.defaultDescriptionField="abstract";a.defaultTextField="text";a.defaultImageField="image";a.defaultDateField="published_date";
a.defaultUrlField="url";b=c.path().trim();b.endsWith("/")&&(b=b.substring(0,b.length-1));b=b.split("/");a.turSiteName=b[b.length-1];a.firstLetters=function(a){return null!=a?(a=a.toUpperCase().split(" "),1<a.length?a[0].charAt(0)+a[1].charAt(0):"\x26nbsp;"+a[0].charAt(0)+"\x26nbsp;"):""};a.updateParameters=function(){a.turQueryString=c.url();a.turQuery=c.search().q;a.turPage=c.search().p;a.turLocale=c.search()._setlocale;a.turSort=c.search().sort;a.turFilterQuery=c.search()["fq[]"];a.turTargetingRule=
c.search()["tr[]"];if(null==a.turQuery||0==a.turQuery.trim().length)a.turQuery="*";if(null==a.turPage||0==a.turPage.trim().length)a.turPage="1";if(null==a.turSort||0==a.turSort.trim().length)a.turSort="relevance"};a.init=function(){a.updateParameters();a.initParams(a.turQuery,a.turPage,a.turLocale,a.turSort,a.turFilterQuery,a.turTargetingRule)};a.initParams=function(b,c,d,e,f,g){h.search(a.turSiteName,b,c,d,e,f,g).then(function(b){a.pageCount=b.data.queryContext.count;a.pageStart=b.data.queryContext.pageStart;
a.pageEnd=b.data.queryContext.pageEnd;a.results=b.data.results.document;a.pages=b.data.pagination;a.facets=b.data.widget.facet;a.facetsToRemove=b.data.widget.facetToRemove;a.defaultTitleField=b.data.queryContext.defaultFields.title;a.defaultDescriptionField=b.data.queryContext.defaultFields.description;a.defaultTextField=b.data.queryContext.defaultFields.text;a.defaultImageField=b.data.queryContext.defaultFields.image;a.defaultDateField=b.data.queryContext.defaultFields.date;a.defaultUrlField=b.data.queryContext.defaultFields.url},
function(a){})};a.initURL=function(b,c,d,e,f,g){h.searchURL(b,c,d,e,f,g).then(function(b){a.pageCount=b.data.queryContext.count;a.pageStart=b.data.queryContext.pageStart;a.pageEnd=b.data.queryContext.pageEnd;a.results=b.data.results.document;a.pages=b.data.pagination;a.facets=b.data.widget.facet;a.facetsToRemove=b.data.widget.facetToRemove},function(a){})};a.init();f.$state=d;a.turRedirect=function(b){c.hash("turHeader");c.url(a.replaceUrlSearch(b));a.updateParameters();m();a.initURL(b)};a.replaceUrlSearch=
function(b){urlFormatted=b.replace("/api/sn/"+a.turSiteName+"/search","/sn/"+a.turSiteName);c.url(urlFormatted);return urlFormatted};a.turChangeSort=function(b){a.updateParameters();b=a.changeQueryStringParameter(a.turQueryString,"sort",b);b=a.changeQueryStringParameter(b,"p",a.turPage);b=a.changeQueryStringParameter(b,"q",a.turQuery);var d=b.replace("/sn/"+a.turSiteName,"/api/sn/"+a.turSiteName+"/search");c.url(b);a.updateParameters();a.initURL(d)};a.changeQueryStringParameter=function(a,b,c){return a.replace(new RegExp("([?\x26]"+
b+"(?\x3d[\x3d\x26#]|$)[^#\x26]*|(?\x3d#|$))"),"\x26"+b+"\x3d"+encodeURIComponent(c)).replace(/^([^?&]+)&/,"$1?")}}]);turingSNApp.factory("turSNSearch",["$http","turAPIServerService",function(a,b){return{search:function(e,d,f,g,c,h,k){d={params:{q:d,p:f,_setlocale:g,sort:c,"fq[]":h,"tr[]":k},headers:{Accept:"application/json"}};return a.get(b.get().concat("/sn/"+e+"/search"),d)},searchURL:function(e){urlFormatted=e.replace("/api/","/");return a.get(b.get().concat(urlFormatted),{headers:{Accept:"application/json"}})}}}]);